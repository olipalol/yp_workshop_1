### Задача

Вы сотрудник Отдела Data Science популярного музыкального стримингового сервиса "МиФаСоль". Сервис расширяет работу с новыми артистами и музыкантами,
в связи с чем возникла задача - правильно классифицировать новые музыкальные треки, чтобы улучшить работу рекомендательной системы. Ваши коллеги из отдела работы со звуком подготовили датасет, в котором собраны некоторые характеристики музыкальных произведений и их жанры. Ваша задача - разработать модель, позволяющую классифицировать музыкальные произведения по жанрам.

Всего у нас 10 жанров: 'Alternative', 'Anime', 'Blues', 'Classical', 'Country',
       'Electronic', 'Hip-Hop', 'Jazz', 'Rap', 'Rock'


### Исходные данные и предобработка

Полных дублей нет 

- пропуски (NaNs, %):
    - track_name	26.69
    - obtained_date	15.66
    - popularity	9.84
    - danceability	5.12
    - mode	4.57
    - key	3.44
- tempo - поравили тип, так как были не цифровые данные

Провели EDA 
- Распределенны "нормально":
    - valence
    - tempo
    - danceability
    - popularity
- Следующие данные сильно лкстеризованы и имеют явные группы:
    - speechiness/instrumentalness/acousticness/liveness
- loudness - распрделен ненормлаьным способом с множеством выбросов
- duration_ms - есть треки длинной в 38 минут. Надо проверить на сколько их.
- duration_ms = -1 - отсуствует информация, неявный пропуск. Заполнили медианным значением по жанрам.

По категорильным колонкам близки тестовая и тренировочная выборки. Распределение по жанрам равномерное по 10% каждого жанра.

На основе анализа добавили следующие признаки:
    - isalpha - в названии только буквы из алфавита
    - count_words - кол-во слов в названии
    - track_name_length - длинна названия
    - chinese_japanese - наличие иероглифов в названии
    - speech_cat - speechiness - Речевой характер определяет наличие в треке разговорной речи. Чем более исключительно речевой характер носит запись (например, ток-шоу, аудиокнига, поэзия), тем ближе значение атрибута к 1,0. # начения выше 0,66 характеризуют треки, которые, вероятно, полностью состоят из разговорной речи. Значения от 0,33 до 0,66 характеризуют треки, которые могут содержать как музыку, так и речь, как в виде фрагментов, так и в виде слоев, включая такие случаи, как рэп-музыка. Значения ниже 0,33, скорее всего, представляют музыку и другие неречевые треки. Разбито на 3 уровня - low/middle/high
    - acoustic_cat - acousticness Разбито на 3 уровня - low/middle/high
    - instrum_cat - - instrumentalness Разбито на 3 уровня - low/middle/high


### Моделирование

Мы протестировали 4 модели с разными гиперпараметрами с помощью RandomizedSearchCV:
- DecisionTreeClassifier
- GradientBoostingClassifier
- KNeighborsClassifier
- RandomForestClassifier
- SVC

Перебор всех моделей с разными парамтерами занял 56 минут 44 сек. (для истории и понимания)
Лучшая модель:
GradientBoostingClassifier(max_depth=5, min_samples_split=7,
                                            n_estimators=140,
                                            random_state=42)
Метрика лучшей модели на тренировочной выборке: 0.605075

Категориальные колонки не важны в классификации, из новых признаков важны:
 - track_name_length
 - japanese_no Chinese or Japanese
 - count_words

Максимальное знаечние у признаков:
- popularity
- acousticness	
- duration_ms
- speechiness	

### Оценка модели и ее интерпретация

Вывод по матрице ошибок:
Модель путает между собой 
- Alternative и Rock
- Hip-Hop и  Rap
- Country и Rock

Самый сложный жанр Alternative - его представителей модель относит как Country и Rock и Hip-Hop.

Если предположить что тестовые данные распределены равномерно, то выбранная модель отдает предпочтение Rock и Hip-Hop против Alternative и Anime


